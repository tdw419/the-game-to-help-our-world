// Full JS content (shortened for brevity in this placeholder)
// Replace this with the full JS code you provided
// Please paste the complete JavaScript here if needed again.
